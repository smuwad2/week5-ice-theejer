<!DOCTYPE html>
<html>

<head>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>

<body>
    <div class="bg-light text-center p-5 mb-4">
        <h2>Choose an option:</h2>
        <label for="limit">Limit:</label>
        <input id="limit" type="number" min=1 max=5 value=1>
        <select onchange="getData()" id="type">
            <option value="customers">Customers</option>
            <option value="products">Products</option>
            <option value="suppliers">Suppliers</option>
        </select>

    </div>
    <div id="result">
        <h2 id="resultType"></h2>
        <table class="table">
            <tbody id="resultTable">

            </tbody>
        </table>
    </div>
    <script>
        async function getData() {
            try {
                const limit = document.getElementById("limit").value;
                const type = document.getElementById("type").value;
                const response = await axios.get("/data", {
                    params: {
                        limit: limit,
                        type: type
                    }
                })
                document.getElementById("resultType").innerText = document.getElementById("type").value;
                console.log(response.data.records);
                var tableElement = document.getElementById("resultTable");

                while(tableElement.firstChild){
                    tableElement.firstChild.remove();
                }

                var tableRow = document.createElement("tr");
                if (response.data.records.length > 0) {
                    for (key in response.data.records[0]) {
                        var tableHeader = document.createElement("th");
                        var textNode = document.createTextNode(key);
                        tableHeader.appendChild(textNode);
                        tableRow.appendChild(tableHeader);
                    }
                    tableElement.appendChild(tableRow);
                }


                for (i = 0; i < response.data.records.length; i++) {
                    tableRow = document.createElement("tr");
                    for (key in response.data.records[i]) {
                        var tableData = document.createElement("td");
                        textNode = document.createTextNode(response.data.records[i][key]);
                        tableData.appendChild(textNode);
                        tableRow.appendChild(tableData);
                    }
                    tableElement.appendChild(tableRow);
                }
            }
            catch (err) {
                console.error(err);
            }
        }

    </script>
</body>

</html>